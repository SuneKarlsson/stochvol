<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Markov Chain Monte Carlo (MCMC) Sampling for the Stochastic Volatility (SV)
Model — svsample • stochvol</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Markov Chain Monte Carlo (MCMC) Sampling for the Stochastic Volatility (SV)
Model — svsample" />
<meta property="og:description" content="svsample simulates from the joint posterior distribution of the SV
parameters mu, phi, sigma (and potentially nu and rho),
along with the latent log-volatilities h_0,...,h_n and returns the
MCMC draws. If a design matrix is provided, simple Bayesian regression can
also be conducted." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stochvol</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gregorkastner/stochvol/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Markov Chain Monte Carlo (MCMC) Sampling for the Stochastic Volatility (SV)
Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/gregorkastner/stochvol/blob/master/R/wrappers.R'><code>R/wrappers.R</code></a></small>
    <div class="hidden name"><code>svsample.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>svsample</code> simulates from the joint posterior distribution of the SV
parameters <code>mu</code>, <code>phi</code>, <code>sigma</code> (and potentially <code>nu</code> and <code>rho</code>),
along with the latent log-volatilities <code>h_0,...,h_n</code> and returns the
MCMC draws. If a design matrix is provided, simple Bayesian regression can
also be conducted.</p>
    </div>

    <pre class="usage"><span class='fu'>svsample</span><span class='op'>(</span>
  <span class='va'>y</span>,
  draws <span class='op'>=</span> <span class='fl'>10000</span>,
  burnin <span class='op'>=</span> <span class='fl'>1000</span>,
  designmatrix <span class='op'>=</span> <span class='cn'>NA</span>,
  priormu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>,
  priorphi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
  priorsigma <span class='op'>=</span> <span class='fl'>1</span>,
  priornu <span class='op'>=</span> <span class='fl'>0</span>,
  priorrho <span class='op'>=</span> <span class='cn'>NA</span>,
  priorbeta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10000</span><span class='op'>)</span>,
  priorlatent0 <span class='op'>=</span> <span class='st'>"stationary"</span>,
  priorspec <span class='op'>=</span> <span class='cn'>NULL</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  thinpara <span class='op'>=</span> <span class='va'>thin</span>,
  thinlatent <span class='op'>=</span> <span class='va'>thin</span>,
  keeptime <span class='op'>=</span> <span class='st'>"all"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  startpara <span class='op'>=</span> <span class='cn'>NULL</span>,
  startlatent <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"no"</span>, <span class='st'>"multicore"</span>, <span class='st'>"snow"</span><span class='op'>)</span>,
  n_cpus <span class='op'>=</span> <span class='fl'>1L</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  n_chains <span class='op'>=</span> <span class='fl'>1L</span>,
  print_progress <span class='op'>=</span> <span class='st'>"automatic"</span>,
  expert <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>svtsample</span><span class='op'>(</span>
  <span class='va'>y</span>,
  draws <span class='op'>=</span> <span class='fl'>10000</span>,
  burnin <span class='op'>=</span> <span class='fl'>1000</span>,
  designmatrix <span class='op'>=</span> <span class='cn'>NA</span>,
  priormu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>,
  priorphi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
  priorsigma <span class='op'>=</span> <span class='fl'>1</span>,
  priornu <span class='op'>=</span> <span class='fl'>0.1</span>,
  priorrho <span class='op'>=</span> <span class='cn'>NA</span>,
  priorbeta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10000</span><span class='op'>)</span>,
  priorlatent0 <span class='op'>=</span> <span class='st'>"stationary"</span>,
  priorspec <span class='op'>=</span> <span class='cn'>NULL</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  thinpara <span class='op'>=</span> <span class='va'>thin</span>,
  thinlatent <span class='op'>=</span> <span class='va'>thin</span>,
  keeptime <span class='op'>=</span> <span class='st'>"all"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  startpara <span class='op'>=</span> <span class='cn'>NULL</span>,
  startlatent <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"no"</span>, <span class='st'>"multicore"</span>, <span class='st'>"snow"</span><span class='op'>)</span>,
  n_cpus <span class='op'>=</span> <span class='fl'>1L</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  n_chains <span class='op'>=</span> <span class='fl'>1L</span>,
  print_progress <span class='op'>=</span> <span class='st'>"automatic"</span>,
  expert <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>svlsample</span><span class='op'>(</span>
  <span class='va'>y</span>,
  draws <span class='op'>=</span> <span class='fl'>20000</span>,
  burnin <span class='op'>=</span> <span class='fl'>2000</span>,
  designmatrix <span class='op'>=</span> <span class='cn'>NA</span>,
  priormu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>,
  priorphi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
  priorsigma <span class='op'>=</span> <span class='fl'>1</span>,
  priornu <span class='op'>=</span> <span class='fl'>0</span>,
  priorrho <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span>,
  priorbeta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10000</span><span class='op'>)</span>,
  priorlatent0 <span class='op'>=</span> <span class='st'>"stationary"</span>,
  priorspec <span class='op'>=</span> <span class='cn'>NULL</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  thinpara <span class='op'>=</span> <span class='va'>thin</span>,
  thinlatent <span class='op'>=</span> <span class='va'>thin</span>,
  keeptime <span class='op'>=</span> <span class='st'>"all"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  startpara <span class='op'>=</span> <span class='cn'>NULL</span>,
  startlatent <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"no"</span>, <span class='st'>"multicore"</span>, <span class='st'>"snow"</span><span class='op'>)</span>,
  n_cpus <span class='op'>=</span> <span class='fl'>1L</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  n_chains <span class='op'>=</span> <span class='fl'>1L</span>,
  print_progress <span class='op'>=</span> <span class='st'>"automatic"</span>,
  expert <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>svtlsample</span><span class='op'>(</span>
  <span class='va'>y</span>,
  draws <span class='op'>=</span> <span class='fl'>20000</span>,
  burnin <span class='op'>=</span> <span class='fl'>2000</span>,
  designmatrix <span class='op'>=</span> <span class='cn'>NA</span>,
  priormu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>,
  priorphi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
  priorsigma <span class='op'>=</span> <span class='fl'>1</span>,
  priornu <span class='op'>=</span> <span class='fl'>0.1</span>,
  priorrho <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span>,
  priorbeta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10000</span><span class='op'>)</span>,
  priorlatent0 <span class='op'>=</span> <span class='st'>"stationary"</span>,
  priorspec <span class='op'>=</span> <span class='cn'>NULL</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  thinpara <span class='op'>=</span> <span class='va'>thin</span>,
  thinlatent <span class='op'>=</span> <span class='va'>thin</span>,
  keeptime <span class='op'>=</span> <span class='st'>"all"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  startpara <span class='op'>=</span> <span class='cn'>NULL</span>,
  startlatent <span class='op'>=</span> <span class='cn'>NULL</span>,
  parallel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"no"</span>, <span class='st'>"multicore"</span>, <span class='st'>"snow"</span><span class='op'>)</span>,
  n_cpus <span class='op'>=</span> <span class='fl'>1L</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  n_chains <span class='op'>=</span> <span class='fl'>1L</span>,
  print_progress <span class='op'>=</span> <span class='st'>"automatic"</span>,
  expert <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>svsample2</span><span class='op'>(</span>
  <span class='va'>y</span>,
  draws <span class='op'>=</span> <span class='fl'>10000</span>,
  burnin <span class='op'>=</span> <span class='fl'>1000</span>,
  designmatrix <span class='op'>=</span> <span class='cn'>NA</span>,
  priormu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span><span class='op'>)</span>,
  priorphi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>1.5</span><span class='op'>)</span>,
  priorsigma <span class='op'>=</span> <span class='fl'>1</span>,
  priornu <span class='op'>=</span> <span class='fl'>0</span>,
  priorrho <span class='op'>=</span> <span class='cn'>NA</span>,
  priorbeta <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>10000</span><span class='op'>)</span>,
  priorlatent0 <span class='op'>=</span> <span class='st'>"stationary"</span>,
  thinpara <span class='op'>=</span> <span class='fl'>1</span>,
  thinlatent <span class='op'>=</span> <span class='fl'>1</span>,
  keeptime <span class='op'>=</span> <span class='st'>"all"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  startpara <span class='op'>=</span> <span class='cn'>NULL</span>,
  startlatent <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>numeric vector containing the data (usually log-returns), which
must not contain zeros. Alternatively, <code>y</code> can be an <code>svsim</code>
object. In this case, the returns will be extracted and a message is signalled.</p></td>
    </tr>
    <tr>
      <th>draws</th>
      <td><p>single number greater or equal to 1, indicating the number of
draws after burn-in (see below). Will be automatically coerced to integer.
The default value is 10000.</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>single number greater or equal to 0, indicating the number of
draws discarded as burn-in. Will be automatically coerced to integer. The
default value is 1000.</p></td>
    </tr>
    <tr>
      <th>designmatrix</th>
      <td><p>regression design matrix for modeling the mean. Must
have <code><a href='https://rdrr.io/r/base/length.html'>length(y)</a></code> rows. Alternatively, <code>designmatrix</code> may be a
string of the form <code>"arX"</code>, where <code>X</code> is a nonnegative integer. To
fit a constant mean model, use <code>designmatrix = "ar0"</code> (which is
equivalent to <code>designmatrix = matrix(1, nrow = length(y))</code>). To fit an
AR(1) model, use <code>designmatrix = "ar1"</code>, and so on. If some elements of
<code>designmatrix</code> are <code>NA</code>, the mean is fixed to zero (pre-1.2.0
behavior of <span class="pkg">stochvol</span>).</p></td>
    </tr>
    <tr>
      <th>priormu</th>
      <td><p>numeric vector of length 2, indicating mean and standard
deviation for the Gaussian prior distribution of the parameter <code>mu</code>,
the level of the log-volatility. The default value is <code><a href='https://rdrr.io/r/base/c.html'>c(0, 100)</a></code>,
which constitutes a practically uninformative prior for common exchange rate
datasets, stock returns and the like.</p></td>
    </tr>
    <tr>
      <th>priorphi</th>
      <td><p>numeric vector of length 2, indicating the shape parameters
for the Beta prior distribution of the transformed parameter
<code>(phi + 1) / 2</code>, where <code>phi</code> denotes the persistence of the
log-volatility. The default value is <code><a href='https://rdrr.io/r/base/c.html'>c(5, 1.5)</a></code>, which constitutes a
prior that puts some belief in a persistent log-volatility but also
encompasses the region where <code>phi</code> is around 0.</p></td>
    </tr>
    <tr>
      <th>priorsigma</th>
      <td><p>single positive real number, which stands for the scaling
of the transformed parameter <code>sigma^2</code>, where <code>sigma</code> denotes the
volatility of log-volatility. More precisely, <code>sigma^2 ~ priorsigma *
chisq(df = 1)</code>. The default value is <code>1</code>, which constitutes a
reasonably vague prior for many common exchange rate datasets, stock returns
and the like.</p></td>
    </tr>
    <tr>
      <th>priornu</th>
      <td><p>single non-negative number, indicating the rate parameter
for the exponential prior distribution of the parameter; can be <code>Inf</code>
<code>nu</code>, the degrees-of-freedom parameter of the conditional innovations
t-distribution. The default value is <code>0</code>, fixing the
degrees-of-freedom to infinity. This corresponds to conditional standard
normal innovations, the pre-1.1.0 behavior of <span class="pkg">stochvol</span>.</p></td>
    </tr>
    <tr>
      <th>priorrho</th>
      <td><p>either <code>NA</code> for the no-leverage case or a numeric
vector of length 2 that specify the beta prior distribution for
<code>(rho+1)/2</code></p></td>
    </tr>
    <tr>
      <th>priorbeta</th>
      <td><p>numeric vector of length 2, indicating the mean and
standard deviation of the Gaussian prior for the regression parameters. The
default value is <code><a href='https://rdrr.io/r/base/c.html'>c(0, 10000)</a></code>, which constitutes a very vague prior
for many common datasets. Not used if <code>designmatrix</code> is <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>priorlatent0</th>
      <td><p>either a single non-negative number or the string
<code>'stationary'</code> (the default, also the behavior before version 1.3.0).
When <code>priorlatent0</code> is equal to <code>'stationary'</code>, the stationary
distribution of the latent AR(1)-process is used as the prior for the
initial log-volatility <code>h_0</code>. When <code>priorlatent0</code> is equal to a
number \(B\), we have \(h_0 \sim N(\mu, B\sigma^2)\) a priori.</p></td>
    </tr>
    <tr>
      <th>priorspec</th>
      <td><p>in case one needs different prior distributions than the
ones specified by <code>priormu</code>, <code>...</code>, <code>priorrho</code>, a <code>priorspec</code>
object can be supplied here. A smart constructor for this usecase is
<a href='specify_priors.html'>specify_priors</a>.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>single number greater or equal to 1, coercible to integer.
Every <code>thinpara</code>th parameter and latent draw is kept and returned. The default
value is 1, corresponding to no thinning of the parameter draws i.e. every
draw is stored.</p></td>
    </tr>
    <tr>
      <th>thinpara</th>
      <td><p>single number greater or equal to 1, coercible to integer.
Every <code>thinpara</code>th parameter draw is kept and returned. The default
value is <code>thin</code>.</p></td>
    </tr>
    <tr>
      <th>thinlatent</th>
      <td><p>single number greater or equal to 1, coercible to integer.
Every <code>thinlatent</code>th latent variable draw is kept and returned. The
default value is <code>thin</code></p></td>
    </tr>
    <tr>
      <th>keeptime</th>
      <td><p>Either 'all' (the default) or 'last'. Indicates which latent
volatility draws should be stored.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>logical value indicating whether the progress bar and other
informative output during sampling should be omitted. The default value is
<code>FALSE</code>, implying verbose output.</p></td>
    </tr>
    <tr>
      <th>startpara</th>
      <td><p><em>optional</em> named list, containing the starting values
for the parameter draws. If supplied, <code>startpara</code> must contain three
elements named <code>mu</code>, <code>phi</code>, and <code>sigma</code>, where <code>mu</code> is
an arbitrary numerical value, <code>phi</code> is a real number between <code>-1</code>
and <code>1</code>, and <code>sigma</code> is a positive real number. Moreover, if
<code>priornu</code> is not <code>0</code>, <code>startpara</code> must also contain an
element named <code>nu</code> (the degrees of freedom parameter for the
t-innovations). The default value is equal to the prior mean. 
In case of parallel execution with <code>cl</code> provided, <code>startpara</code> can be a list of
named lists that initialize the parallel chains.</p></td>
    </tr>
    <tr>
      <th>startlatent</th>
      <td><p><em>optional</em> vector of length <code><a href='https://rdrr.io/r/base/length.html'>length(y)</a></code>,
containing the starting values for the latent log-volatility draws. The
default value is <code><a href='https://rdrr.io/r/base/rep.html'>rep(-10, length(y))</a></code>.
In case of parallel execution with <code>cl</code> provided, <code>startlatent</code> can be a list of
named lists that initialize the parallel chains.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p><em>optional</em> one of <code>"no"</code> (default), <code>"multicore"</code>, or <code>"snow"</code>,
indicating what type of parallellism is to be applied. Option
<code>"multicore"</code> is not available on Windows.</p></td>
    </tr>
    <tr>
      <th>n_cpus</th>
      <td><p><em>optional</em> positive integer, the number of CPUs to be used in case of
parallel computations. Defaults to <code>1L</code>. Ignored if parameter
<code>cl</code> is supplied and <code>parallel != "snow"</code>.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p><em>optional</em> so-called SNOW cluster object as implemented in package
<code>parallel</code>. Ignored unless <code>parallel == "snow"</code>.</p></td>
    </tr>
    <tr>
      <th>n_chains</th>
      <td><p><em>optional</em> positive integer specifying the number of independent MCMC chains</p></td>
    </tr>
    <tr>
      <th>print_progress</th>
      <td><p><em>optional</em> one of <code>"automatic"</code>, <code>"progressbar"</code>,
or <code>"iteration"</code>, controls the output. Ignored if <code>quiet</code> is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>expert</th>
      <td><p><em>optional</em> named list of expert parameters. For most
applications, the default values probably work best. Interested users are
referred to the literature provided in the References section. If
<code>expert</code> is provided, it may contain the following named elements:</p><ul>
<li><p>interweaveLogical value. If <code>TRUE</code> (the default),
then ancillarity-sufficiency interweaving strategy (ASIS) is applied
to improve on the sampling efficiency for the parameters.
Otherwise one parameterization is used.</p></li>
<li><p>correct_model_misspecificationLogical value. If <code>FALSE</code>
(the default), then auxiliary mixture sampling is used to sample the latent
states. If <code>TRUE</code>, extra computations are made to correct for model
misspecification either ex-post by reweighting or on-line using a
Metropolis-Hastings step.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any extra arguments will be forwarded to
<code><a href='updatesummary.html'>updatesummary</a></code>, controlling the type of statistics calculated
for the posterior draws.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The value returned is a list object of class <code>svdraws</code> holding</p>
<dt>para</dt><dd><p><code>mcmc.list</code> object containing the <em>parameter</em> draws from
the posterior distribution.</p></dd>
<dt>latent</dt><dd><p><code>mcmc.list</code> object containing the
<em>latent instantaneous log-volatility</em> draws from the posterior
distribution.</p></dd>
<dt>latent0</dt><dd><p><code>mcmc.list</code> object containing the <em>latent
initial log-volatility</em> draws from the posterior distribution.</p></dd>
<dt>tau</dt><dd><p><code>mcmc.list</code> object containing the <em>latent variance inflation
factors</em> for the sampler with conditional t-innovations <em>(optional)</em>.</p></dd>
<dt>beta</dt><dd><p><code>mcmc.list</code> object containing the <em>regression coefficient</em>
draws from the posterior distribution <em>(optional)</em>.</p></dd>
<dt>y</dt><dd><p>the left hand side of the observation equation, usually
the argument <code>y</code>. In case of an AR(<code>k</code>) specification, the
first <code>k</code> elements are removed.</p></dd>
<dt>runtime</dt><dd><p><code>proc_time</code> object containing the
run time of the sampler.</p></dd>
<dt>priors</dt><dd><p>a <code>priorspec</code> object containing the parameter
values of the prior distributions for <code>mu</code>,
<code>phi</code>, <code>sigma</code>, <code>nu</code>, <code>rho</code>, and
<code>beta</code>s, and the variance of specification for <code>latent0</code>.</p></dd>
<dt>thinning</dt><dd><p><code>list</code> containing the thinning
parameters, i.e. the arguments <code>thinpara</code>, <code>thinlatent</code> and
<code>keeptime</code>.</p></dd>
<dt>summary</dt><dd><p><code>list</code> containing a collection of
summary statistics of the posterior draws for <code>para</code>, <code>latent</code>,
and <code>latent0</code>.</p></dd>
<dt>meanmodel</dt><dd><p><code>character</code> containing information about how <code>designmatrix</code>
was employed.</p></dd>

To display the output, use print, summary and plot. The
print method simply prints the posterior draws (which is very likely
a lot of output); the summary method displays the summary statistics
currently stored in the object; the plot method
<a href='plot.svdraws.html'>plot.svdraws</a> gives a graphical overview of the posterior
distribution by calling <a href='volplot.html'>volplot</a>, traceplot and
densplot and displaying the results on a single page.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Functions <code>svtsample</code>, <code>svlsample</code>, and <code>svtlsample</code> are
wrappers around <code>svsample</code> with convenient default values for the SV
model with t-errors, leverage, and both t-errors and leverage, respectively.</p>
<p>For details concerning the algorithm please see the paper by Kastner and
Frühwirth-Schnatter (2014).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If <code>y</code> contains zeros, you might want to consider de-meaning your
returns or use <code>designmatrix = "ar0"</code>.</p>
<p><code>svsample2</code> is deprecated.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kastner, G. and Frühwirth-Schnatter, S. (2014).
Ancillarity-sufficiency interweaving strategy (ASIS) for boosting MCMC
estimation of stochastic volatility models. <em>Computational Statistics &amp;
Data Analysis</em>, <b>76</b>, 408--423,
doi: <a href='https://doi.org/10.1016/j.csda.2013.01.002'>10.1016/j.csda.2013.01.002</a>
.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='svsim.html'>svsim</a></code>, <code><a href='specify_priors.html'>specify_priors</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>###############</span>
<span class='co'># Full examples</span>
<span class='co'>###############</span>

<span class='co'># Example 1</span>
<span class='co'>## Simulate a short and highly persistent SV process </span>
<span class='va'>sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='svsim.html'>svsim</a></span><span class='op'>(</span><span class='fl'>100</span>, mu <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10</span>, phi <span class='op'>=</span> <span class='fl'>0.99</span>, sigma <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>

<span class='co'>## Obtain 5000 draws from the sampler (that's not a lot)</span>
<span class='va'>draws</span> <span class='op'>&lt;-</span>
  <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>sim</span>, draws <span class='op'>=</span> <span class='fl'>5000</span>, burnin <span class='op'>=</span> <span class='fl'>100</span>,
           priormu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>, <span class='fl'>1</span><span class='op'>)</span>, priorphi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>, <span class='fl'>1.5</span><span class='op'>)</span>, priorsigma <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Extracted data vector from 'svsim'-object.</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'>
<span class='co'>## Check out the results</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>draws</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Summary of 'svdraws' object
#&gt; 
#&gt; Prior distributions:
#&gt; mu        ~ Normal(mean = -10, sd = 1)
#&gt; (phi+1)/2 ~ Beta(a = 20, b = 1.5)
#&gt; sigma^2   ~ Gamma(shape = 0.5, rate = 2.5)
#&gt; nu        ~ Infinity
#&gt; rho       ~ Constant(value = 0)
#&gt; 
#&gt; Stored 5000 MCMC draws after a burn-in of 100.
#&gt; No thinning.
#&gt; 
#&gt; Posterior draws of SV parameters (thinning = 1):
#&gt;               mean     sd       5%      50%     95%  ESS
#&gt; mu        -10.3074 0.3109 -10.8123 -10.2893 -9.8546 1142
#&gt; phi         0.8701 0.1013   0.6667   0.8971  0.9814  263
#&gt; sigma       0.2301 0.1214   0.0603   0.2155  0.4477  290
#&gt; exp(mu/2)   0.0058 0.0009   0.0045   0.0058  0.0072 1142
#&gt; sigma^2     0.0677 0.0708   0.0036   0.0464  0.2004  290
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>draws</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Simulation object extracted from input</span></div><div class='img'><img src='svsample-1.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># \donttest{</span>
<span class='co'># Example 2</span>
<span class='co'>## Simulate an asymmetric and conditionally heavy-tailed SV process</span>
<span class='va'>sim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='svsim.html'>svsim</a></span><span class='op'>(</span><span class='fl'>150</span>, mu <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10</span>, phi <span class='op'>=</span> <span class='fl'>0.96</span>, sigma <span class='op'>=</span> <span class='fl'>0.3</span>, nu <span class='op'>=</span> <span class='fl'>10</span>, rho <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.3</span><span class='op'>)</span>

<span class='co'>## Obtain 10000 draws from the sampler</span>
<span class='co'>## Use more advanced prior settings</span>
<span class='co'>## Run two parallel MCMC chains</span>
<span class='va'>advanced_draws</span> <span class='op'>&lt;-</span>
  <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>sim</span>, draws <span class='op'>=</span> <span class='fl'>10000</span>, burnin <span class='op'>=</span> <span class='fl'>5000</span>,
           priorspec <span class='op'>=</span> <span class='fu'><a href='specify_priors.html'>specify_priors</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='fu'><a href='sv_constant.html'>sv_normal</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>, <span class='fl'>1</span><span class='op'>)</span>,
                                      sigma2 <span class='op'>=</span> <span class='fu'><a href='sv_constant.html'>sv_gamma</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>2</span><span class='op'>)</span>,
                                      rho <span class='op'>=</span> <span class='fu'><a href='sv_constant.html'>sv_beta</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>4</span><span class='op'>)</span>,
                                      nu <span class='op'>=</span> <span class='fu'><a href='sv_constant.html'>sv_constant</a></span><span class='op'>(</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,
           parallel <span class='op'>=</span> <span class='st'>"snow"</span>, n_chains <span class='op'>=</span> <span class='fl'>2</span>, n_cpus <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Extracted data vector from 'svsim'-object.</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'>
<span class='co'>## Check out the results</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>advanced_draws</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Summary of 'svdraws' object
#&gt; 
#&gt; Prior distributions:
#&gt; mu        ~ Normal(mean = -10, sd = 1)
#&gt; (phi+1)/2 ~ Beta(a = 5, b = 1.5)
#&gt; sigma^2   ~ Gamma(shape = 0.5, rate = 2)
#&gt; nu        ~ Constant(value = 5)
#&gt; rho       ~ Beta(a = 4, b = 4)
#&gt; 
#&gt; Stored 10000 MCMC draws after a burn-in of 5000.
#&gt; No thinning.
#&gt; 
#&gt; Posterior draws of SV parameters (thinning = 1):
#&gt;              mean     sd       5%     50%   95%  ESS
#&gt; mu        -9.8020 0.3685 -10.3919 -9.7975 -9.22 2250
#&gt; phi        0.8687 0.0838   0.7012  0.8865  0.97  201
#&gt; sigma      0.4418 0.1531   0.2256  0.4237  0.72  169
#&gt; rho       -0.0783 0.1890  -0.3851 -0.0795  0.24  277
#&gt; exp(mu/2)  0.0076 0.0014   0.0055  0.0075  0.01 2250
#&gt; sigma^2    0.2186 0.1510   0.0509  0.1796  0.51  169
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>advanced_draws</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Simulation object extracted from input</span></div><div class='img'><img src='svsample-2.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Example 3</span>
<span class='co'>## AR(1) structure for the mean</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>exrates</span><span class='op'>)</span>
<span class='va'>len</span> <span class='op'>&lt;-</span> <span class='fl'>3000</span>
<span class='va'>ahead</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>exrates</span><span class='op'>$</span><span class='va'>USD</span>, <span class='va'>len</span><span class='op'>)</span>

<span class='co'>## Fit AR(1)-SVL model to EUR-USD exchange rates</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>y</span>, designmatrix <span class='op'>=</span> <span class='st'>"ar1"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'>
<span class='co'>## Use predict.svdraws to obtain predictive distributions</span>
<span class='va'>preddraws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>, steps <span class='op'>=</span> <span class='va'>ahead</span><span class='op'>)</span>

<span class='co'>## Calculate predictive quantiles</span>
<span class='va'>predquants</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>preddraws</span><span class='op'>$</span><span class='va'>y</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>quantile</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.5</span>, <span class='fl'>.9</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Visualize</span>
<span class='va'>expost</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>exrates</span><span class='op'>$</span><span class='va'>USD</span>, <span class='va'>len</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>, <span class='va'>ahead</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/ts.plot.html'>ts.plot</a></span><span class='op'>(</span><span class='va'>y</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>4</span><span class='op'>*</span><span class='va'>ahead</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>,
         ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>predquants</span>, <span class='va'>expost</span>, <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='fl'>4</span><span class='op'>*</span><span class='va'>ahead</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>, <span class='va'>predquants</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span>,
        col <span class='op'>=</span> <span class='fl'>3</span>, lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>, <span class='va'>expost</span>,
      col <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='svsample-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Example 4</span>
<span class='co'>## Predicting USD based on JPY and GBP in the mean</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>exrates</span><span class='op'>)</span>
<span class='va'>len</span> <span class='op'>&lt;-</span> <span class='fl'>3000</span>
<span class='va'>ahead</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>
<span class='co'>## Calculate log-returns</span>
<span class='va'>logreturns</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>exrates</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"USD"</span>, <span class='st'>"JPY"</span>, <span class='st'>"GBP"</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>2</span>,
                    <span class='kw'>function</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>logretUSD</span> <span class='op'>&lt;-</span> <span class='va'>logreturns</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>, <span class='st'>"USD"</span><span class='op'>]</span>
<span class='va'>regressors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>logreturns</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>len</span>, <span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># lagged by 1 day</span>

<span class='co'>## Fit SV model to EUR-USD exchange rates</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>logretUSD</span>, designmatrix <span class='op'>=</span> <span class='va'>regressors</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'>
<span class='co'>## Use predict.svdraws to obtain predictive distributions</span>
<span class='va'>predregressors</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>logreturns</span><span class='op'>[</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>preddraws</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>res</span>, steps <span class='op'>=</span> <span class='va'>ahead</span>,
                     newdata <span class='op'>=</span> <span class='va'>predregressors</span><span class='op'>)</span>
<span class='va'>predprice</span> <span class='op'>&lt;-</span> <span class='va'>exrates</span><span class='op'>[</span><span class='va'>len</span><span class='op'>+</span><span class='fl'>2</span>, <span class='st'>"USD"</span><span class='op'>]</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>preddraws</span><span class='op'>$</span><span class='va'>y</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>1</span>, <span class='va'>cumsum</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Calculate predictive quantiles</span>
<span class='va'>predquants</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>predprice</span>, <span class='fl'>2</span>, <span class='va'>quantile</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.1</span>, <span class='fl'>.5</span>, <span class='fl'>.9</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Visualize</span>
<span class='va'>priceUSD</span> <span class='op'>&lt;-</span> <span class='va'>exrates</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>:</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='fl'>2</span><span class='op'>)</span>, <span class='st'>"USD"</span><span class='op'>]</span>
<span class='va'>expost</span> <span class='op'>&lt;-</span> <span class='va'>exrates</span><span class='op'>[</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>:</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>+</span><span class='fl'>2</span><span class='op'>)</span>, <span class='st'>"USD"</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/stats/ts.plot.html'>ts.plot</a></span><span class='op'>(</span><span class='va'>priceUSD</span>, xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>len</span><span class='op'>-</span><span class='fl'>4</span><span class='op'>*</span><span class='va'>ahead</span>, <span class='va'>len</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>,
         ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>expost</span>, <span class='va'>predquants</span>, <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>priceUSD</span>, <span class='fl'>4</span><span class='op'>*</span><span class='va'>ahead</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>len</span><span class='op'>:</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>priceUSD</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='va'>predquants</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span><span class='op'>)</span>,
        col <span class='op'>=</span> <span class='fl'>3</span>, lty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>len</span><span class='op'>:</span><span class='op'>(</span><span class='va'>len</span><span class='op'>+</span><span class='va'>ahead</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>tail</a></span><span class='op'>(</span><span class='va'>priceUSD</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='va'>expost</span><span class='op'>)</span>,
      col <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='img'><img src='svsample-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'>########################</span>
<span class='co'># Further short examples</span>
<span class='co'>########################</span>

<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='svsim.html'>svsim</a></span><span class='op'>(</span><span class='fl'>50</span>, nu <span class='op'>=</span> <span class='fl'>10</span>, rho <span class='op'>=</span> <span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>$</span><span class='va'>y</span>

<span class='co'># Supply initial values</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>y</span>,
                startpara <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10</span>, sigma <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'>
<span class='co'># \donttest{</span>
<span class='co'># Supply initial values for parallel chains</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>y</span>,
                startpara <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='op'>-</span><span class='fl'>10</span>, sigma <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                                 <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='op'>-</span><span class='fl'>11</span>, sigma <span class='op'>=</span> <span class='fl'>.1</span>, phi <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span>,
                                 <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='op'>-</span><span class='fl'>9</span>, sigma <span class='op'>=</span> <span class='fl'>.3</span>, phi <span class='op'>=</span> <span class='fl'>0.7</span><span class='op'>)</span><span class='op'>)</span>,
                parallel <span class='op'>=</span> <span class='st'>"snow"</span>, n_chains <span class='op'>=</span> <span class='fl'>3</span>, n_cpus <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'>
<span class='co'># Parallel chains with with a pre-defined cluster object</span>
<span class='va'>cl</span> <span class='op'>&lt;-</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='st'>"PSOCK"</span>, outfile <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>  <span class='co'># print to console</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>y</span>,
                parallel <span class='op'>=</span> <span class='st'>"snow"</span>, n_chains <span class='op'>=</span> <span class='fl'>3</span>, cl <span class='op'>=</span> <span class='va'>cl</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='input'><span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span>
<span class='co'># }</span>

<span class='co'># Turn on correction for model misspecification</span>
<span class='co'>## Since the approximate model is fast and it is working very</span>
<span class='co'>##   well in practice, this is turned off by default</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>y</span>,
                expert <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>correct_model_misspecification <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='output co'>#&gt; <span class='message'>Summarizing posterior draws...</span></div><div class='output co'>#&gt; <span class='message'>No computation of effective sample size after re-sampling</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Summary of 'svdraws' object
#&gt; 
#&gt; Prior distributions:
#&gt; mu        ~ Normal(mean = 0, sd = 100)
#&gt; (phi+1)/2 ~ Beta(a = 5, b = 1.5)
#&gt; sigma^2   ~ Gamma(shape = 0.5, rate = 0.5)
#&gt; nu        ~ Infinity
#&gt; rho       ~ Constant(value = 0)
#&gt; 
#&gt; Stored 10000 MCMC draws after a burn-in of 1000.
#&gt; No thinning.
#&gt; 
#&gt; Posterior draws of SV parameters (thinning = 1):
#&gt;             mean    sd      5%    50%    95%
#&gt; mu        -8.629 0.425 -9.2107 -8.613 -8.102
#&gt; phi        0.619 0.277  0.0808  0.680  0.954
#&gt; sigma      0.343 0.224  0.0403  0.312  0.751
#&gt; exp(mu/2)  0.014 0.046  0.0100  0.013  0.017
#&gt; sigma^2    0.168 0.213  0.0016  0.098  0.564
#&gt; 
#&gt; Posterior draws from the auxiliary SV model were re-sampled after the MCMC
#&gt; procedure ended to correct for model mis-specification.
#&gt;   Re-sampling of parameters and latents was of little practical importance:
#&gt;     - max reachable entropy for this sample size: 9.21034,
#&gt;     - entropy of the re-sampling weight distribution: 9.210287
#&gt; </div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># Parallel multicore chains (not available on Windows)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>svsample</span><span class='op'>(</span><span class='va'>y</span>, draws <span class='op'>=</span> <span class='fl'>30000</span>, burnin <span class='op'>=</span> <span class='fl'>10000</span>,
                parallel <span class='op'>=</span> <span class='st'>"multicore"</span>, n_chains <span class='op'>=</span> <span class='fl'>3</span>, n_cpus <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># Plot using a color palette</span>
<span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span><span class='op'>(</span><span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/nchain.html'>nchain</a></span><span class='op'>(</span><span class='fu'><a href='extractors.html'>para</a></span><span class='op'>(</span><span class='va'>res</span>, <span class='st'>"all"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>

<span class='co'># Use functionality from package 'coda'</span>
<span class='co'>## E.g. Geweke's convergence diagnostics</span>
<span class='fu'>coda</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coda/man/geweke.diag.html'>geweke.diag</a></span><span class='op'>(</span><span class='fu'><a href='extractors.html'>para</a></span><span class='op'>(</span><span class='va'>res</span>, <span class='st'>"all"</span><span class='op'>)</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mu"</span>, <span class='st'>"phi"</span>, <span class='st'>"sigma"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>

<span class='co'># Use functionality from package 'bayesplot'</span>
<span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'>mcmc_pairs</span><span class='op'>(</span><span class='va'>res</span>, pars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sigma"</span>, <span class='st'>"mu"</span>, <span class='st'>"phi"</span>, <span class='st'>"h_0"</span>, <span class='st'>"h_15"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Darjus Hosszejni, Gregor Kastner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


